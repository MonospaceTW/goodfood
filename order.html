<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>order</title>
  <script src="js/vue.js"></script>
</head>
<body>
  <div id="app">
    <!-- <my-component :prop-c="userName" :prop-e0="orderList" :prop-e="dishes"></my-component> -->
    <my-component></my-component>
  </div>
  <script type="text/x-template" id="my-component">
    <div>
      <ul>
        <li v-for="(item, index) in dishes">
          <span>{{item.dishName}}</span>
          <button type="button" @click="reduce(index)">-</button>
          <input type="text" v-model="item.count"/>
          <button type="button" @click="add(index)">+</button>
          <span>{{item.price}}元</span>
        </li>
      </ul>
      <span>我是</span>
      <input type="text" v-model="name">
      <a href="#" @click="userOrder">下訂單</a>
      <a href="orderResult.html?orderId=1">看團訂結果</a>
      <a href="order.html?orderId=1">分享這頁</a>
    </div>
  </script>
  
<script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBMRANtWtuf5Quz26GxkEnb4rRJ1t7OAkg",
    authDomain: "goodfood-39158.firebaseapp.com",
    databaseURL: "https://goodfood-39158.firebaseio.com",
    projectId: "goodfood-39158",
    storageBucket: "goodfood-39158.appspot.com",
    messagingSenderId: "940303768399"
  };
  firebase.initializeApp(config);
</script>
<script>
  var usersRef = firebase.database().ref('users');

  Vue.component('my-component', {
    // props: {
    //   propC: {
    //     type: String,
    //     required: true
    //   },
    //   propE0: {
    //     type: Object,
    //   },
    //   propE: {
    //     type: Object,
    //     default: function () {
    //     return { message: 'hello' }
    //     }
    //   }
    // },
    template: '#my-component',
    data: function(){
      return {
        name: '',
        orderList: [],
        dishes:[
          {storeID: 2, dishId: 1, dishName: '合菜便當', count: 0, price: 60},
          {storeID: 2, dishId: 2,  dishName: '雙主菜便當', count: 0, price: 65},
          {storeID: 2, dishId: 3,  dishName: '雙主菜便當', count: 0, price: 65},
          {storeID: 2, dishId: 4, dishName: '紅燒排骨飯', count: 0, price: 65},
          {storeID: 2, dishId: 5, dishName: '酥炸雞腿飯', count: 0, price: 65},
          {storeID: 2, dishId: 6, dishName: '蒜泥白肉飯', count: 0, price: 65},
          {storeID: 2, dishId: 7, dishName: '宮保雞丁飯', count: 0, price: 65},
          {storeID: 2, dishId: 8, dishName: '迷迭香腿排飯', count: 0, price: 65},
          {storeID: 2, dishId: 9, dishName: '香煎嫩雞排飯', count: 0, price: 65},
          {storeID: 2, dishId: 10, dishName: '蜜汁雞腿飯', count: 0, price: 65},
          {storeID: 2, dishId: 11, dishName: '客家油雞飯', count: 0, price: 65},
          {storeID: 2, dishId: 12, dishName: '古早味排骨飯', count: 0, price: 65},
          {storeID: 2, dishId: 13, dishName: '秋刀魚飯', count: 0, price: 65},
          {storeID: 2, dishId: 14, dishName: '老三烤肉飯', count: 0, price: 65},
          {storeID: 2, dishId: 15, dishName: '蜜汁腿排飯', count: 0, price: 70},
          {storeID: 2, dishId: 16, dishName: '老三魯排骨飯', count: 0, price: 70},
          {storeID: 2, dishId: 17, dishName: '香煎銀班魚飯', count: 0, price: 70},
          {storeID: 2, dishId: 18, dishName: '老三招牌飯', count: 0, price: 70},
          {storeID: 2, dishId: 19, dishName: '酥炸雞排飯', count: 0, price: 75},
          {storeID: 2, dishId: 20, dishName: '炭烤雞排飯', count: 0, price: 75},
          {storeID: 2, dishId: 21, dishName: '煎虱目魚肚飯', count: 0, price: 75},
          {storeID: 2, dishId: 22, dishName: '炭烤大雞腿飯', count: 0, price: 75},
          {storeID: 2, dishId: 23, dishName: '廣東滷雞腿飯', count: 0, price: 75},
          {storeID: 2, dishId: 24, dishName: '酥炸大雞腿飯', count: 0, price: 75},
          {storeID: 2, dishId: 25, dishName: '蜜汁大雞腿飯', count: 0, price: 75},
          {storeID: 2, dishId: 26, dishName: '吉士豬排飯', count: 0, price: 75},
          {storeID: 2, dishId: 27, dishName: '香煎鱈魚飯', count: 0, price: 80},
          {storeID: 2, dishId: 28, dishName: '紅燒牛腩飯', count: 0, price: 85},
        ],
      }
    },

    methods: {
      add(index){
        this.dishes[index].count += 1;
      },
      reduce(index){
        if(this.dishes[index].count >= 1){
          this.dishes[index].count -= 1;
        }
      },
      userOrder(){
        const orderDish = this.dishes.filter((dish)=>{
          //return dish;
          return dish.count >= 1;
        });
        this.orderList.push({
          userID: this.userID,
          name: this.name,
          order: orderDish,
        });
        this.orderList = JSON.stringify(this.orderList);
        location.href = "orderConfirm.html?orderList=" + this.orderList;
      }
    },

  });

  const vm = new Vue({
    el: '#app',
    data: {
    },
  });
</script>

</body>
</html>